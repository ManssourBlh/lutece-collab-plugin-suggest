<section class="content">
	<div class="row">
	  <div class="col-xs-12 col-sm-12">
			<div class="box box-primary">
				<div class="box-header">
					<h3 class="box-title">#i18n{digglike.manageCommentSubmit.rowTitleDiggSubmitTitle} :
						<#if digg_submit.diggSubmitTitle?exists>
							<#if digg_submit.diggSubmitTitle?length &gt; 100>
								${digg_submit.diggSubmitTitle?substring(0,100)}...
							<#else>
								${digg_submit.diggSubmitTitle}
							</#if>
						</#if>
						<#if digg_submit.reported><span class="label label-important">#i18n{digglike.manageDiggSubmit.altWarning}</span></#if>
					</h3>
					<div class="box-tools">
						<#if digg_submit.diggSubmitState.number=disable_state_number>
			        <a class="btn btn-xs btn-flat btn-primary" href="jsp/admin/plugins/digglike/DoChangeDiggSubmitState.jsp?id_digg_submit=${digg_submit.idDiggSubmit}&state_number=${waiting_for_publish_state_number}&comment=comment#${digg_submit.idDiggSubmit}" title="#i18n{digglike.manageDiggSubmit.altWaitingForPublish}">
								<i class="fa fa-info-circle"></i>
							</a>
							<a class="btn btn-xs btn-flat btn-success" href="jsp/admin/plugins/digglike/DoChangeDiggSubmitState.jsp?id_digg_submit=${digg_submit.idDiggSubmit}&state_number=${publish_state_number}&comment=comment#${digg_submit.idDiggSubmit}" title="#i18n{digglike.manageDiggSubmit.altPublish}">
								<i class="fa fa-check"></i>
							</a>
						<#elseif digg_submit.diggSubmitState.number=waiting_for_publish_state_number >
						<a class="btn btn-xs btn-flat btn-warning" href="jsp/admin/plugins/digglike/DoChangeDiggSubmitState.jsp?id_digg_submit=${digg_submit.idDiggSubmit}&state_number=${disable_state_number}&comment=comment#${digg_submit.idDiggSubmit}" title="#i18n{digglike.manageDiggSubmit.altDisable}">
							<i class="fa fa-pause"></i>
						</a>
						 <a class="btn btn-xs btn-flat btn-success" href="jsp/admin/plugins/digglike/DoChangeDiggSubmitState.jsp?id_digg_submit=${digg_submit.idDiggSubmit}&state_number=${publish_state_number}&comment=comment#${digg_submit.idDiggSubmit}" title="#i18n{digglike.manageDiggSubmit.altPublish}">
						   <i class="fa fa-check"></i>
						</a>
						<#elseif digg_submit.diggSubmitState.number=publish_state_number >
			        <a class="btn btn-xs btn-flat btn-primary" href="jsp/admin/plugins/digglike/DoChangeDiggSubmitState.jsp?id_digg_submit=${digg_submit.idDiggSubmit}&state_number=${disable_state_number}&comment=comment#${digg_submit.idDiggSubmit}" title="#i18n{digglike.manageDiggSubmit.altDisable}">
								<i class="fa fa-remove"></i>
							</a>
							<a class="btn btn-xs btn-flat btn-success" href="jsp/admin/plugins/digglike/DoChangeDiggSubmitState.jsp?id_digg_submit=${digg_submit.idDiggSubmit}&state_number=${waiting_for_publish_state_number}&comment=comment#${digg_submit.idDiggSubmit}" title="#i18n{digglike.manageDiggSubmit.altWaitingForPublish}">
								<i class="fa fa-check"></i>
							</a>
						</#if>
						<a class="btn btn-xs btn-flat btn-danger" href="jsp/admin/plugins/digglike/ConfirmRemoveDiggSubmit.jsp?id_digg_submit=${digg_submit.idDiggSubmit}" title="#i18n{digglike.manageDiggSubmit.altDelete}">
							<i class="fa fa-trash"></i>
						</a>
						<#if digg_submit_prev!=-1>
						<a class="btn btn-xs btn-flat btn-primary" href="jsp/admin/plugins/digglike/ManageCommentSubmit.jsp?id_digg_submit=${digg_submit_prev}" title="#i18n{digglike.manageCommentSubmit.altPrevDiggSubmit}">
					  		<i class="fa fa-arrow-circle-o-left"></i>
						</a>
						</#if>
						<#if digg_submit_next!=-1>
						<a class="btn btn-xs btn-flat btn-primary" href="jsp/admin/plugins/digglike/ManageCommentSubmit.jsp?id_digg_submit=${digg_submit_next}" title="#i18n{digglike.manageCommentSubmit.altNextDiggSubmit}">
							<i class="fa fa-arrow-circle-o-right"></i>
						</a>
						</#if>
						<button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-xs-12 col-sm-3">
		<div class="box box-primary">
			<div class="box-header">
				<h3 class="box-title"></h3>
			</div>
			<div class="box-body">
				<form action="jsp/admin/plugins/digglike/ManageCommentSubmit.jsp" method="post" name="" id="filter">
				<div class="form-group">
					<label class="control-label col-xs-12 col-sm-12 col-md-3 col-lg-3" for="id_comment_state">#i18n{digglike.manageCommentSubmit.labelState}</label>
					<div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">
						<@comboWithParams name="id_comment_state" default_value=comment_state_selected?string additionalParameters=" class=\"input-medium\"" items=comment_state_list />
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-xs-12 col-sm-12 col-md-3 col-lg-3" for="id_contains_sub_comment_disable">#i18n{digglike.manageCommentSubmit.labelContainsSubCommentDisable}</label>
					<div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">
						<@comboWithParams name="id_contains_sub_comment_disable" default_value=comment_contains_sub_comment_disable_selected?string  additionalParameters=" class=\"input-small\"" items=comment_contains_sub_comment_disable_list  />
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-xs-12 col-sm-12 col-md-3 col-lg-3" for="id_comment_sort">#i18n{digglike.manageCommentSubmit.labelSort}</label>
					<div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">
						<@comboWithParams name="id_comment_sort" default_value=comment_sort_selected?string additionalParameters=" class=\"input-medium\"" items=comment_sort_list />
					</div>
				</div>
				<button class="btn btn-primary btn-xs btn-flat" type="submit">
					<i class="fa fa-filter"></i>&nbsp;#i18n{digglike.manageCommentSubmit.buttonSearch}
				</button>
			</form>
		</div>
		</div>
		<div class="box box-primary">
			<div class="box-header">
				<h3 class="box-title"></h3>
			</div>
			<div class="box-body">
						<#if digg_submit.reported>
								<span class="label label-important">#i18n{digglike.manageDiggSubmit.altWarning}</span>
								<span class="pull-right">
									<i id="display_advert" class="glyphicon glyphicon-chevron-down" title="Afficher les signalements"></i>
								</span>
								<#if digg_submit.reportedMessages?has_content>
									<#list digg_submit.reportedMessages  as  reported_messages>
						         ${reported_messages.value}
							      	<small>${reported_messages.dateReported}</small>
							  	  </#list>
									</#if>
						</#if>
						#i18n{digglike.manageCommentSubmit.rowDateDiggSubmit}: <strong>${digg_submit.dateResponse?date?string.short}</strong>
						#i18n{digglike.manageCommentSubmit.rowStateDiggSubmit}: <#if digg_submit.diggSubmitState.number=publish_state_number>
						<span class="label label-success" title="#i18n{digglike.manageDiggSubmit.rowDiggSubmitState}"><i class="fa fa-check"></i> ;#i18n{digglike.manageDiggSubmit.altPublish}</span>
				<#elseif digg_submit.diggSubmitState.number=waiting_for_publish_state_number>
						<span class="label label-warning" title="#i18n{digglike.manageDiggSubmit.rowDiggSubmitState}"><i class="glyphicon glyphicon-white icon-pause"></i>&nbsp;#i18n{digglike.manageDiggSubmit.altWaitingForPublish}</span>
				<#else>
						<span class="label label-important" title="#i18n{digglike.manageDiggSubmit.rowDiggSubmitState}"><i class="glyphicon glyphicon-white icon-remove"></i>&nbsp;#i18n{digglike.manageDiggSubmit.altDisable}</span>
				</#if>
				<#if digg.diggSubmitTypes?has_content && digg.diggSubmitTypes?size &gt; 0 >
					<p>#i18n{digglike.manageCommentSubmit.rowDiggSubmitType}:
							<#if digg_submit.diggSubmitType?has_content>
								<strong>${digg_submit.diggSubmitType.name}</strong>
							</#if>
						</p>
					</#if>
					<p>#i18n{digglike.manageCommentSubmit.rowCategory}:</p>
						<#if category_list?has_content>
					<form method="post" class="form-horizontal" action="jsp/admin/plugins/digglike/DoChangeDiggSubmitCategory.jsp">
						<input name="id_digg_submit" value="${digg_submit.idDiggSubmit}" type="hidden">
						<input name="comment" value="comment" type="hidden">
						<#if digg_submit.category?exists>
							<@combo name="id_category" items=category_list default_value="${digg_submit.category.idCategory}" />
						<#else>
							<@combo name="id_category" items=category_list default_value="-1" />
						</#if>
						<button type="submit" class="btn btn-primary btn-xs btn-flat" title="#i18n{digglike.manageDiggSubmit.buttonModify}">
							<i class="fa fa-chek"></i>
						</button>
						</form>
					</#if>
				<#if !digg_submit.disableVote>
					<i class="fa fa-star"></i>&nbsp;#i18n{digglike.manageDiggSubmit.rowNumberVote} : ${digg_submit.numberVote}
					<i class="fa fa-thumbs-up"></i>&nbsp;#i18n{digglike.manageDiggSubmit.rowNumberScore} : ${digg_submit.numberScore}
				</#if>
				<#if !digg_submit.disableComment>
					<div class="label label-info">
						<i class="fa fa-comment"></i>&nbsp;#i18n{digglike.manageDiggSubmit.rowNumberComment} : ${digg_submit.numberComment}
						#i18n{digglike.manageDiggSubmit.rowNumberCommentEnable} : ${digg_submit.numberCommentEnable} /
						#i18n{digglike.manageDiggSubmit.rowNumberCommentIdle} : ${digg_submit.numberComment - digg_submit.numberCommentEnable}
					</div>
				</#if>
				<form method="post" class="form-horizontal" action="jsp/admin/plugins/digglike/DoSubmitOfficialAnswer.jsp" id="addOfficialComment">
					<h3>#i18n{digglike.manageCommentSubmit.officialAnswer} <small>#i18n{digglike.manageCommentSubmit.labelAddOfficialAnswer}</h3>
					<input name="id_digg_submit" value="${digg_submit.idDiggSubmit}" type="hidden">
					<textarea name="comment_value" id="comment_value" rows="6" class="col-xs-12 col-sm-12 col-md-12 col-lg-12" <#if digg.activeEditorBbcode> class='markitup'</#if>></textarea>
					<button type="submit" class="btn btn-primary btn-xs btn-flat" name="add">
						<i class="fa fa-plus"></i>&nbsp;#i18n{digglike.manageCommentSubmit.buttonAdd}
					</button>
				</form>
			</div>
			</div>
			</div>
			<div class="col-xs-12 col-sm-9">
				<div class="box box-primary">
					<div class="box-header">
						<h3 class="box-title"></h3>
					</div>
					<div class="box-body">
					<@paginationAdmin paginator=paginator combo=1 />
					<#list comment_submit_list as comment_submit>
						<div class="callout callout-info">
							<#if comment_submit.isOfficialAnswer()><span class="badge badge-info pull-right">#i18n{digglike.manageCommentSubmit.officialAnswer}</span></#if>
							<p id="comment${comment_submit.idCommentSubmit}">
								<strong>#i18n{digglike.manageCommentSubmit.rowValueCommentSubmit}
								<#if comment_submit.active>
									<span class="label label-success">#i18n{digglike.manageCommentSubmit.stateEnable}</span>
								<#else>
									<span class="label label-important" id="not_published_${comment_submit.idCommentSubmit}">#i18n{digglike.manageCommentSubmit.stateDisable}</span>
								</#if>
								</strong>
							</p>
							<pre>${digg.parseBbcodeValue(comment_submit.value)}</pre>
							<form method="post" class="form-inline pull-right" action="jsp/admin/plugins/digglike/DoChangeCommentSubmit.jsp#comment${comment_submit.idCommentSubmit}">
								<input name="id_comment_submit" value="${comment_submit.idCommentSubmit}" type="hidden">
								<#if comment_submit.active>
									<button type="submit" class="btn btn-xs btn-flat btn-primary" name="disable">
										<i class="fa fa-remove"></i> #i18n{digglike.manageCommentSubmit.buttonDisable}
									</button>
								<#else>
									<button type="submit" class="btn btn-xs btn-flat btn-primary" name="enable">
										<i class="fa fa-check"></i>&nbsp;#i18n{digglike.manageCommentSubmit.buttonEnable}
									</button>
								</#if>
									<button type="submit" class="btn btn-xs btn-flat btn-danger" name="delete">
										<i class="fa fa-trash"></i>&nbsp;#i18n{digglike.manageCommentSubmit.buttonDelete}
									</button>
							</form>
							<p>
							<p>
							#i18n{digglike.manageCommentSubmit.rowDateCommentSubmit}: <strong>${comment_submit.dateComment!}&nbsp;</strong>
							<#if comment_submit.comments?has_content>
							<span>
							&nbsp;#i18n{digglike.manageCommentSubmit.rowLastDateCommentSubmit}: <strong>${comment_submit.dateModify!}&nbsp;</strong>
							</span>
							</#if>
							</p>
							<#if comment_submit.comments?has_content>
							<p class="comment_toggle" id="comment_toggle${comment_submit.idCommentSubmit}"><i class="fa fa-chevron-down"></i>&nbsp;#i18n{digglike.manageCommentSubmit.ShowSubComments}</p>
							<div class="commentComments">
								<#list comment_submit.comments as comment_comment>
								<blockquote id="comment${comment_comment.idCommentSubmit}">
									<#if comment_comment.isOfficialAnswer()><span class="badge badge-info pull-right">#i18n{digglike.manageCommentSubmit.officialAnswer}</span></#if>
									<p>
									<strong>#i18n{digglike.manageCommentSubmit.rowValueCommentSubmit}
									<#if comment_comment.active>
										<span class="label label-success">#i18n{digglike.manageCommentSubmit.stateEnable}</span>
									<#else>
										<span class="label label-important">#i18n{digglike.manageCommentSubmit.stateDisable}</span>
									</#if>
									</strong>
									</p>
									<pre>${digg.parseBbcodeValue(comment_comment.value)}</pre>
									<p>#i18n{digglike.manageCommentSubmit.rowDateCommentSubmit}:  ${comment_comment.dateComment!} </p>
									<form method="post" action="jsp/admin/plugins/digglike/DoChangeCommentSubmit.jsp#comment${comment_comment.idCommentSubmit}">
									<input name="id_comment_submit" value="${comment_comment.idCommentSubmit}" type="hidden">
									<input name="id_parent" value="${comment_submit.idCommentSubmit}" type="hidden">
									<#if comment_comment.active>
										<button type="submit" class="btn btn-xs btn-flat btn-primary" name="disable"><i class="fa fa-remove"></i>&nbsp;#i18n{digglike.manageCommentSubmit.buttonDisable}</button>
									<#else>
										<button type="submit" class="btn btn-xs btn-flat btn-primary" name="enable"><i class="fa fa-check"></i>&nbsp;#i18n{digglike.manageCommentSubmit.buttonEnable}</button>
									</#if>
									<button type="submit" class="btn btn-xs btn-flat btn-danger" name="delete"><i class="fa fa-trash"></i>&nbsp;#i18n{digglike.manageCommentSubmit.buttonDelete}</button>
									</form>
								</blockquote>
								</#list>
							</div>
							</#if>
						</div>
					</#list>
				</div>
			</div>
		</div>
	</div>
</div>
</section>


<script>
$(document).ready( function () {
	/* Search modal */
	$("head").append('<link href="css/admin/bootstrap-modal.css" rel="stylesheet">');
	$("#myModalCommentSearch").addClass("modal hide fade modal-top");

	/* Add reinit button if a query has been set */
	var nQuery=0;
	$("#myModalCommentSearch select option:selected").each( function(){
		if( $(this).val() >= 0  ){nQuery++;}
	});

	if( nQuery > 0){
		$('#myModalLabelCommentSearch').after('<a href="#" id="init" class="btn btn-xs btn-flat btn-danger spaced"><i class="glyphicon glyphicon-refresh"></i> #i18n{digglike.manageDiggSubmit.buttonReinitSearch} </a>');
		$("a#init").click( function(){
			$("#myModalCommentSearch select option:selected").each( function(){
				$(this).val(-1);
			});
			$("input#session").val("");
			$("form#filter").submit();
			return false;
		});
	}

	var toGo = location.hash;
	if (toGo != ""){
		$('html, body').animate( {'scrollTop':$(toGo).offset().top - 600 },0 );
	}

	var nav = $('.fixed-actionbar');
    $(window).scroll(function () {
        if ($(this).scrollTop() > 200) {
            nav.addClass("f-nav offset3 span9");
        } else {
            nav.removeClass("f-nav offset3 span9");
        }
    });

	var addUp = true;
	$("div.commentComments").toggle();
	doToggle( ".comment_toggle" );
	$("#advert_content").toggle();
	$("#display_advert").click( function(){
		$("#advert_content").toggle();
		if ( addUp ){
			$(this).addClass("icon-chevron-up");
			$(this).removeClass("icon-chevron-down");
			addUp = true;
		} else {
			$(this).removeClass("icon-chevron-up");
			$(this).addClass("icon-chevron-down");
			addUp = false;
		}
	});

	$(".comment_toggle").each( function(){
		var cId= $(this).attr("id");
		var n = $(this).next().find("span").hasClass("label-important");
		console.log( n  );
			if( $(this).next().find("span").hasClass("label-important") ){
				// Add all unpublished comments info
				$(this).append(" <span class=\"badge badge-warning\"><i class=\"icon-exclamation-sign\"></i>#i18n{digglike.manageCommentSubmit.buttonContainsEnableSubComment}</span>")
			};

		}
	);

	<#if id_parent?has_content>
		$("#comment_toggle${id_parent}").next().toggle();
	</#if>
});

function doToggle( idParent ){
	$( idParent ).click( function(){
		$(this).next().toggle();
	});
}
</script>

<#include "/util/editor/editor.html" />
<@initEditor  />
